<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D8PMW3CCL2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-D8PMW3CCL2",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Ditto" href="/opensearch.xml">
<!-- Google Tag Manager -->
    <script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-PV7QFWF",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>
    <!-- End Google Tag Manager -->
<script src="/js/fix-trailing-slash.js"></script><title data-react-helmet="true">3 - Showing the List of Tasks | Ditto</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.ditto.live/csharp/tutorial/xamarin/tasks-list-screen"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-csharp-current"><meta data-react-helmet="true" property="og:title" content="3 - Showing the List of Tasks | Ditto"><meta data-react-helmet="true" name="description" content="In the last part of the tutorial we setup the user interface using the Xcode interfaace builder and created a custom class TasksTableViewController"><meta data-react-helmet="true" property="og:description" content="In the last part of the tutorial we setup the user interface using the Xcode interfaace builder and created a custom class TasksTableViewController"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.ditto.live/csharp/tutorial/xamarin/tasks-list-screen"><link data-react-helmet="true" rel="alternate" href="https://docs.ditto.live/csharp/tutorial/xamarin/tasks-list-screen" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.ditto.live/csharp/tutorial/xamarin/tasks-list-screen" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://F25GUUSPFJ-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.307ab48c.css">
<link rel="preload" href="/assets/js/runtime~main.98c36bfd.js" as="script">
<link rel="preload" href="/assets/js/main.f111a804.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="25" height="25"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button><a href="https://ditto.live" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/logo.png" alt="Ditto Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.png" alt="Ditto Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Ditto</b></a><a class="navbar__item navbar__link" href="/">Documentation</a><a href="https://github.com/getditto/samples" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span class="inline">Example Apps</span></a><a href="https://github.com/getditto" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span class="inline">Open Source</span></a><a href="https://github.com/getditto/docs/discussions/categories/roadmap-and-ideas" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span class="inline">Roadmap</span></a><a class="navbar__item navbar__link" href="/changelog">Changelog</a><a class="navbar__item navbar__link" href="/faq">FAQ</a></div><div class="navbar__items navbar__items--right"><a href="https://portal.ditto.live" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span class="inline">Login</span></a><div class="searchBox_Bc3W"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_LIo8"><nav class="overflow-y-auto menu thin-scrollbar overflow-x-visible menu_oAhv menuWithAnnouncementBar_IVfW"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-undefined menu__list-item"><a class="menu__link" href="/csharp/installation">Installation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Tutorials</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-NaN menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Xamarin</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/tutorial/xamarin/setup">1 - Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/tutorial/xamarin/configure-ditto">2 - Configure Ditto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/csharp/tutorial/xamarin/tasks-list-screen">3 - Showing the List of Tasks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/tutorial/xamarin/edit-screen">4 - Editing Tasks</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-NaN menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">C# Console App</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item"><a class="menu__link menu__link--sublist" href="#">Getting Started</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/common/concepts/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/common/concepts/documents">Documents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/common/concepts/writing">Writing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/common/concepts/querying">Querying</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/common/concepts/syncing-data">Syncing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/common/concepts/remove">Removing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/csharp/common/concepts/designing-permissions">Access Control Permissions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Data Model</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Mesh Network</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Quick Tips</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Security</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Change Data Capture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">How it Works</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-undefined menu__list-item"><a href="https://software.ditto.live/dotnet/Ditto/3.0.0/api-reference/" target="_blank" rel="noopener noreferrer" class="menu__link"><span>API Reference</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-undefined menu__list-item"><a class="menu__link" href="/csharp/common/v3">3.0 Migration guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-undefined menu__list-item"><a class="menu__link" href="/csharp/common/troubleshooting">Troubleshooting</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_MGa7"><div class="docItemContainer_PQH2"><article class="prose max-w-none"><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_psec"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>3 - Showing the List of Tasks</h1></header><p>In the last part of the tutorial we setup the user interface using the Xcode interfaace builder and created a custom class TasksTableViewController</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="3-1-setup-taskstableviewcontroller-class">3-1 Setup TasksTableViewController class<a aria-hidden="true" class="hash-link" href="#3-1-setup-taskstableviewcontroller-class" title="Direct link to heading">​</a></h2><p>First, we need to add some variables that will be created on <code>viewDidLoad</code> of the <code>TasksTableViewController</code> so adjust the class to match this code:</p><div class="codeBlockContainer_EiTO"><div style="color:#9CDCFE;background-color:#1E1E1E" class="codeBlockTitle_PQMO">TasksTableViewController.cs</div><div class="codeBlockContent_X2I6 csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_UxnK thin-scrollbar"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#9CDCFE"><span class="token plain">using System;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">using UIKit;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Remember to import Ditto</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">using DittoSDK;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">using System.Collections.Generic;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">namespace Tasks</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public partial class TasksTableViewController : UITableViewController</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // These hold references to Ditto for easy access</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private DittoLiveQuery liveQuery;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private DittoSubscription subscription;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private Ditto ditto</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            get</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                var appDelegate = (AppDelegate)UIApplication.SharedApplication.Delegate;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                return appDelegate.ditto;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private DittoCollection collection</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            get</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                return this.ditto.Store.Collection(&quot;tasks&quot;);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // List that will contain all the tasks</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        List&lt;Task&gt; tasks = new List&lt;Task&gt;();</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // data source for the TasksTableViewController</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        private TasksTableSource tasksTableSource = new TasksTableSource();</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public TasksTableViewController(IntPtr handle) : base(handle)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public override void ViewWillAppear(bool animated)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            base.ViewWillAppear(animated);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            TableView.Source = tasksTableSource;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public override void ViewDidLoad()</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            base.ViewDidLoad();</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            setupTaskList();</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Sets up Live Query for syncing</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public void setupTaskList()</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            subscription = ditto.Store[&quot;tasks&quot;].Find(&quot;!isDeleted&quot;).Subscribe()</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            liveQuery = ditto.Store[&quot;tasks&quot;].Find(&quot;!isDeleted&quot;).ObserveLocal((docs, _event) =&gt;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                tasks = docs.ConvertAll(d =&gt; new Task(d));</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                tasksTableSource.updateTasks(tasks);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                InvokeOnMainThread(() =&gt;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    TableView.ReloadData();</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                });</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            });</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            ditto.Store[&quot;tasks&quot;].Find(&quot;isDeleted == true&quot;).Evict();</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // Creates a new task</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        partial void didClickAddTask(UIBarButtonItem sender)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            // Create an alert</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            var alertControl = UIAlertController.Create(</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                title: &quot;Add New Task&quot;,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                message: null,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                preferredStyle: UIAlertControllerStyle.Alert);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            // Add a text field to the alert for the new task text</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            alertControl.AddTextField(configurationHandler: (UITextField obj) =&gt; obj.Placeholder = &quot;Enter Task&quot;);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            alertControl.AddAction(UIAlertAction.Create(title: &quot;Cancel&quot;, style: UIAlertActionStyle.Cancel, handler: null));</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            // Add a &quot;OK&quot; button to the alert.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            alertControl.AddAction(UIAlertAction.Create(title: &quot;OK&quot;, style: UIAlertActionStyle.Default, alarm =&gt; addTask(alertControl.TextFields[0].Text)));</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            // Present the alert to the user</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            PresentViewController(alertControl, animated: true, null);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public void addTask(string text)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            var dict = new Dictionary&lt;string, object&gt;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                {&quot;body&quot;, text},</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                {&quot;isCompleted&quot;, false}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            };</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            var docId = this.collection.Upsert(dict);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><p>Let&#x27;s break down what this code does. First, we create the variables needed and then initialize them in <code>ViewWillAppear()</code>.</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_UxnK thin-scrollbar"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#9CDCFE"><span class="token plain">// These hold references to Ditto for easy access</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">private DittoLiveQuery liveQuery;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">private Ditto ditto</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    get</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        var appDelegate = (AppDelegate)UIApplication.SharedApplication.Delegate;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return appDelegate.ditto;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">private DittoCollection collection</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    get</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        return this.ditto.Store.Collection(&quot;tasks&quot;);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// List that will contain all the tasks</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">List&lt;Task&gt; tasks = new List&lt;Task&gt;();</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// data source for the TasksTableViewController</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">private TasksTableSource tasksTableSource = new TasksTableSource();</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public TasksTableViewController(IntPtr handle) : base(handle)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public override void ViewWillAppear(bool animated)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    base.ViewWillAppear(animated);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    TableView.Source = tasksTableSource;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><p>After setting up the variables and starting Ditto, we then use Ditto&#x27;s key API to observe changes to the database by creating a live-query in the <code>setupTaskList()</code> function. This allows us to set the initial state of the UITableView after the query is immediately run and then subsequently get callbacks for any new data changes that occur locally or that were synced from other devices:</p><p>Note, that we are using the <code>observe</code> API in Ditto. This API performs two functions. First, it sets up a local observer for data changes in the database that match the query and second it creates a subscription for the same query that will be used to request this data from other devices. For simplicity, we are using this combined API, but you can also call them independently.</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_UxnK thin-scrollbar"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#9CDCFE"><span class="token plain">public override void ViewDidLoad()</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    base.ViewDidLoad();</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    setupTaskList();</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Sets up Live Query for syncing</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public void setupTaskList()</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    liveQuery = ditto.Store[&quot;tasks&quot;].Find(&quot;!isDeleted&quot;).ObserveLocal((docs, _event) =&gt;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        tasks = docs.ConvertAll(d =&gt; new Task(d));</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // We will implement this later</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        tasksTableSource.updateTasks(tasks);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        InvokeOnMainThread(() =&gt;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            TableView.ReloadData();</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        });</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    });</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><p>This is a best-practice when using Ditto, since it allows your UI to simply react to data changes which can come at any time given the ad-hoc nature of how Ditto synchronizes with nearby devices. With this in place, we can now add user actions and configure the UITableview to display the tasks.</p><p>Look in the <code>TasksTableViewController.design.cs</code> file and you should see <code>[Action (&quot;didClickAddTask:&quot;)]</code> <code>partial void didClickAddTask (UIKit.UIBarButtonItem sender);</code>. This is the button we created earlier in Xcode.
Now we need to add an action to it.</p><div class="codeBlockContainer_EiTO"><div class="codeBlockContent_X2I6 csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_UxnK thin-scrollbar"><code class="codeBlockLines_W6UD"><span class="token-line" style="color:#9CDCFE"><span class="token plain">// Triggered when add button is pressed</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">partial void didClickAddTask(UIBarButtonItem sender)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Create an alert</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var alertControl = UIAlertController.Create(</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        title: &quot;Add New Task&quot;,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        message: null,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        preferredStyle: UIAlertControllerStyle.Alert);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Add a text field to the alert for the new task text</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    alertControl.AddTextField(configurationHandler: (UITextField obj) =&gt; obj.Placeholder = &quot;Enter Task&quot;);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    alertControl.AddAction(UIAlertAction.Create(title: &quot;Cancel&quot;, style: UIAlertActionStyle.Cancel, handler: null));</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Add an &quot;OK&quot; button to the alert.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    alertControl.AddAction(UIAlertAction.Create(title: &quot;OK&quot;, style: UIAlertActionStyle.Default, alarm =&gt; addTask(alertControl.TextFields[0].Text)));</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Present the alert to the user</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    PresentViewController(alertControl, animated: true, null);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">public void addTask(string text)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var dict = new Dictionary&lt;string, object&gt;</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {&quot;body&quot;, text},</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {&quot;isCompleted&quot;, false},</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {&quot;isDeleted&quot;, false}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    };</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // Adds the new task to the ditto collection</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var docId = this.collection.Upsert(dict);</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_V-PD clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><p>When we <code>Upsert</code> the new task into the ditto collection then the live query that is observing the collection will be triggered.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/getditto/docs/tree/main/docs/csharp/tutorial/xamarin/3-tasks-list-screen.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/csharp/tutorial/xamarin/configure-ditto"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->2 - Configure Ditto</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/csharp/tutorial/xamarin/edit-screen"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">4 - Editing Tasks<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#3-1-setup-taskstableviewcontroller-class" class="table-of-contents__link toc-highlight">3-1 Setup TasksTableViewController class</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Documentation</a></li><li class="footer__item"><a href="https://www.ditto.live/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Main Website</span></a></li><li class="footer__item"><a href="https://github.com/getditto/samples" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Example Apps</span></a></li><li class="footer__item"><a class="footer__link-item" href="/changelog">Changelog</a></li><li class="footer__item"><a href="https://portal.ditto.live" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Login</span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/getditto/docs/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub Discussions</span></a></li><li class="footer__item"><a href="https://github.com/getditto/docs/discussions/categories/roadmap-and-ideas" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Roadmap</span></a></li><li class="footer__item"><a href="https://github.com/getditto/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Open Source</span></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/ditto" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow</span></a></li><li class="footer__item"><a href="https://twitter.com/dittolive" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter</span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 DittoLive, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.98c36bfd.js"></script>
<script src="/assets/js/main.f111a804.js"></script>
<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PV7QFWF" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) --></body>
</html>
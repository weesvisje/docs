<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D8PMW3CCL2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-D8PMW3CCL2",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Ditto" href="/opensearch.xml">
<!-- Google Tag Manager -->
    <script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-PV7QFWF",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>
    <!-- End Google Tag Manager --><title data-react-helmet="true">3 - Showing the List of Tasks | Ditto</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.ditto.live/ios/tutorial/swift/tasks-list-screen"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-ios-current"><meta data-react-helmet="true" property="og:title" content="3 - Showing the List of Tasks | Ditto"><meta data-react-helmet="true" name="description" content="In the last part of the tutorial we referenced a class called TasksListScreen. This screen will show a List using a JetPack Compose Column."><meta data-react-helmet="true" property="og:description" content="In the last part of the tutorial we referenced a class called TasksListScreen. This screen will show a List using a JetPack Compose Column."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.ditto.live/ios/tutorial/swift/tasks-list-screen"><link data-react-helmet="true" rel="alternate" href="https://docs.ditto.live/ios/tutorial/swift/tasks-list-screen" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.ditto.live/ios/tutorial/swift/tasks-list-screen" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://F25GUUSPFJ-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1d3676ae.css">
<link rel="preload" href="/assets/js/runtime~main.c44b045c.js" as="script">
<link rel="preload" href="/assets/js/main.35dec2f9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="25" height="25"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button><a href="https://ditto.live" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/logo.png" alt="Ditto Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/logo.png" alt="Ditto Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">Ditto</b></a><a class="navbar__item navbar__link" href="/">Documentation</a><a href="https://github.com/getditto/samples" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span class="inline">Example Apps</span></a><a href="https://github.com/getditto" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span class="inline">Open Source</span></a><a href="https://github.com/getditto/docs/discussions/categories/roadmap-and-ideas" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span class="inline">Roadmap</span></a><a class="navbar__item navbar__link" href="/changelog">Changelog</a><a class="navbar__item navbar__link" href="/faq">FAQ</a></div><div class="navbar__items navbar__items--right"><a href="https://portal.ditto.live" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span class="inline">Login</span></a><div class="searchBox_xXbB"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_3jCp"><nav class="overflow-y-auto menu thin-scrollbar overflow-x-visible menu_1DcY menuWithAnnouncementBar_3IKd"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-undefined menu__list-item"><a class="menu__link" href="/ios/installation">Installation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Tutorial</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-NaN menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">SwiftUI</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/ios/tutorial/swift/setup">1 - Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/ios/tutorial/swift/configure-ditto">2 - Configure Ditto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ios/tutorial/swift/tasks-list-screen">3 - Showing the List of Tasks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/ios/tutorial/swift/edit-screen">4 - Editing Tasks</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-NaN menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">UIKit</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item"><a class="menu__link menu__link--sublist" href="#">Main Concepts</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/ios/common/concepts/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/ios/common/concepts/documents">Documents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/ios/common/concepts/update">Update</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/ios/common/concepts/upsert">Upsert</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/ios/common/concepts/querying">Querying</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/ios/common/concepts/remove">Remove</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/ios/common/concepts/evict">Evict</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/ios/common/concepts/transactions">Transactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-NaN menu__list-item"><a class="menu__link" tabindex="0" href="/ios/common/concepts/syncing-data">Syncing Data</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Data Model</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Mesh Network</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Quick Tips</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Security</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Integration Guides</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-undefined menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">How it Works</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-undefined menu__list-item"><a href="https://software.ditto.live/cocoa/DittoSwift/2.0.0-alpha1/api-reference/" target="_blank" rel="noopener noreferrer" class="menu__link"><span>API Reference</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-undefined menu__list-item"><a class="menu__link" href="/ios/common/supported-platforms">Supported Platforms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-undefined menu__list-item"><a class="menu__link" href="/ios/common/troubleshooting">Troubleshooting</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_2rXS"><div class="docItemContainer_1EXp"><article class="prose max-w-none"><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_Ftrd"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>3 - Showing the List of Tasks</h1></header><p>In the last part of the tutorial we referenced a class called <code>TasksListScreen</code>. This screen will show a <code>List&lt;Task&gt;</code> using a JetPack Compose Column.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="3-1-create-a-taskrow-views">3-1 Create a <code>TaskRow</code> views<a aria-hidden="true" class="hash-link" href="#3-1-create-a-taskrow-views" title="Direct link to heading">​</a></h2><p>Each row of the tasks will be represented by a SwiftUI <code>View</code> called <code>TaskRow</code> which takes in a <code>Task</code> and two callbacks which we will use later.</p><ol><li>If the <code>task.isCompleted</code> is <code>true</code>, we will show a filled circle icon and a
strikethrough style for the <code>body</code>.</li><li>If the <code>task.isCompleted</code> is <code>false</code>, we will show an open circle icon.</li><li>If the user taps the <code>Icon</code>, we will call a <code>onToggle: ((_ task: Task) -&gt; Void)?</code>, we will reverse the <code>isCompleted</code> from <code>true</code> to <code>false</code> or <code>false</code> to <code>true</code></li><li>If the user taps the <code>Text</code>, we will call a <code>onClickBody: ((_ task: Task) -&gt; Void)?</code>. We will use this to navigate an <code>EditScreen</code> (we will create this later)</li></ol><p>For brevity, we will skip discussions on styling as it&#x27;s best to see the code snippet below:</p><p>We&#x27;ve also included a <code>TaskRow_Previews</code> that allows you to see the end result with some test data quickly.</p><p><img alt="TaskRowPreview" src="/assets/images/xcode-taskrow-preview-ef754ad4365c50b084ebdf0a938e3085.png"></p><div class="codeBlockContainer_2gih"><div style="color:#9CDCFE;background-color:#1E1E1E" class="codeBlockTitle_1Kb7">TaskRow.swift</div><div class="codeBlockContent_3z4W swift"><pre tabindex="0" class="prism-code language-swift codeBlock_6upA thin-scrollbar"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#9CDCFE"><span class="token plain">import SwiftUI</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">struct TaskRow: View {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    let task: Task</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var onToggle: ((_ task: Task) -&gt; Void)?</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var onClickBody: ((_ task: Task) -&gt; Void)?</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var body: some View {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        HStack {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            // 2.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            Image(systemName: task.isCompleted ? &quot;circle.fill&quot;: &quot;circle&quot;)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .renderingMode(.template)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .foregroundColor(.accentColor)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                .onTapGesture {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    onToggle?(task)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            if task.isCompleted {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                Text(task.body)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    // 2.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    .strikethrough()</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    .onTapGesture {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        onClickBody?(task)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            } else {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                // 3.</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                Text(task.body)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    .onTapGesture {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        onClickBody?(task)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">struct TaskRow_Previews: PreviewProvider {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    static var previews: some View {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        List {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            TaskRow(task: Task(body: &quot;Get Milk&quot;, isCompleted: true))</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            TaskRow(task: Task(body: &quot;Do Homework&quot;, isCompleted: false))</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            TaskRow(task: Task(body: &quot;Take out trash&quot;, isCompleted: true))</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="3-2-create-a-taskslistscreenviewmodel">3-2 Create a <code>TasksListScreenViewModel</code><a aria-hidden="true" class="hash-link" href="#3-2-create-a-taskslistscreenviewmodel" title="Direct link to heading">​</a></h2><p>In the world of SwiftUI, the most important design pattern is the MVVM, which stands for Model-View-ViewModel. MVVM strives to separate all data manipulation (Model and ViewModel) and data presentation (UI or View) into distinct areas of concern. When it comes to Ditto, we recommend that you never include references to edit <code>ditto</code> in <code>View.body</code>. All interactions with <code>ditto</code> for <code>upsert</code>, <code>update</code>, <code>find</code>, <code>remove</code> and <code>observe</code> should be within a <code>ViewModel</code>. The View should only render data from observable variables from the <code>ViewModel</code> and only the <code>ViewModel</code> should make direct edits to these variables.</p><p>Typically we create a <code>ViewModel</code> per screen or per page of an application. For the <code>TasksListScreen</code> we need some functionality like:</p><ul><li>Showing a realtime list of <code>Task</code> objects</li><li>Triggering an intention to edit a <code>Task</code></li><li>Triggering an intention to create a <code>Task</code></li><li>Clicking an icon to toggle the icon from <code>true</code> to <code>false</code> or <code>false</code> to <code>true</code></li></ul><p>In SwiftUI we create a view model by inheriting the <code>ObservableObject</code>. The <code>ObservableObject</code> allows SwiftUI to watch changes to certain variables to trigger view updates intelligently. To learn more about <code>ObservableObject</code> we recommend this excellent <a href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-use-observedobject-to-manage-state-from-external-objects" target="_blank" rel="noopener noreferrer">tutorial from Hacking with Swift</a>.</p><ol><li>Create a file called <strong>TasksListScreenViewModel.swift</strong> in your project</li><li>Add an <code>init</code> constructor to pass in a <code>ditto: Ditto</code> instance and store it in a local variable.</li><li>Create two <code>@Published</code> variables for <code>tasks</code> and i<code>sPresentingEditScreen</code>. <code>@Published</code> variables are special variables of an <code>ObservableObject</code>. If these variables change, SwiftUI will update the view accordingly. Any variables that are <em>not</em> decorated with <code>@Published</code> can change but will be ignored by SwiftUI.</li><li>We also add a normal variable, <code>private(set) var taskToEdit: Task? = nil</code>. When a user is attempting to <em>edit</em> a task, we need to tell the view model which task the user would like to edit. This does not need to trigger a view reload, so it&#x27;s a simple variable.</li><li>Here&#x27;s where the magic happens. As soon as the <code>TasksListScreenViewModel</code> is initialized, we need to <code>.observe</code> all the tasks by creating a live query. To prevent the <code>liveQuery</code> from being prematurely deallocated, we store it as a variable. In the observe callback, we convert all the documents into <code>Task</code> objects and set it to the <code>@Published tasks</code> variable. Every time to <code>.observe</code> fires, SwiftUI will pick up the changes and tell the view to render the list of tasks.</li><li>Add a function called <code>toggle()</code>. When a user clicks on a task&#x27;s image icon, we need to trigger reversing the <code>isCompleted</code> state. In the function body we add a standard call to find the task by it&#x27;s <code>_id</code> and attempt to mutate the <code>isCompleted</code> property.</li><li>Add a function called <code>clickedBody</code>. When the user taps the <code>TaskRow</code>&#x27;s <code>Text</code> field, we need to store that task and change the <code>isPresentingEditScreen</code> to true. This will give us enough information to present a <code>.sheet</code> in the <code>TasksListScreenViewModel</code> to feed to the <code>EditScreen</code></li><li>In the previous setup of the <code>TasksListScreen</code>, we added a <code>navigationBarItem</code> with a plus icon. When the user clicks this button we need to tell the view model that it should show the <code>EditScreen</code>. So we&#x27;ve set the <code>isPresentingEditScreen</code> property to <code>true</code>. However, because we are attempting to <em>create</em> a <code>Task</code>, we need to set the <code>taskToEdit</code> to <code>nil</code> because we don&#x27;t yet have a task.</li></ol><div class="codeBlockContainer_2gih"><div style="color:#9CDCFE;background-color:#1E1E1E" class="codeBlockTitle_1Kb7">TasksListScreenViewModel.swift</div><div class="codeBlockContent_3z4W swift"><pre tabindex="0" class="prism-code language-swift codeBlock_6upA thin-scrollbar"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#9CDCFE"><span class="token plain">class TasksListScreenViewModel: ObservableObject {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // 3.</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    @Published var tasks = [Task]()</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    @Published var isPresentingEditScreen: Bool = false</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // 4.</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    private(set) var taskToEdit: Task? = nil</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    let ditto: Ditto</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // 5.</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    var liveQuery: DittoLiveQuery?</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    init(ditto: Ditto) {</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">        self.ditto = ditto</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">        self.liveQuery = ditto.store[&quot;tasks&quot;]</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">            .findAll()</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">            .observe(eventHandler: {  docs, _ in</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">                self.tasks = docs.map({ Task(document: $0) })</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">            })</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // 6.</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    func toggle(task: Task) {</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">        self.ditto.store[&quot;tasks&quot;].findByID(task._id)</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">            .update { mutableDoc in</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">                guard let mutableDoc = mutableDoc else { return }</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">                mutableDoc[&quot;isCompleted&quot;].set(!mutableDoc[&quot;isCompleted&quot;].boolValue)</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">            }</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // 7.</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    func clickedBody(task: Task) {</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">        taskToEdit = task</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">        isPresentingEditScreen = true</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // 8.</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    func clickedPlus() {</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">        taskToEdit = nil</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">        isPresentingEditScreen = true</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="3-3-render-taskrow-in-a-foreach-within-the-taskslistscreen">3-3 Render <code>TaskRow</code> in a <code>ForEach</code> within the <code>TasksListScreen</code><a aria-hidden="true" class="hash-link" href="#3-3-render-taskrow-in-a-foreach-within-the-taskslistscreen" title="Direct link to heading">​</a></h2><p>Now we need to update our <code>TasksListScreen</code> to properly bind any callbacks, events, and data to the <code>TasksListScreenViewModel</code>.</p><ol><li>Back in the <code>TasksListScreen</code> view, we need to construct our <code>TasksListScreenViewModel</code> and store it as an <code>@ObservedObject</code>. This <code>@ObservedObject</code> tells the view to watch for specific changes in the <code>viewModel</code> variable.</li><li>We will need to store our <code>ditto</code> object to pass to the <code>EditScreen</code> later.</li><li>In our <code>body</code> variable, find the <code>List</code> and add:</li></ol><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W swift"><pre tabindex="0" class="prism-code language-swift codeBlock_6upA thin-scrollbar"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#9CDCFE"><span class="token plain">ForEach(viewModel.tasks) { task in</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    TaskRow(task: task,</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        onToggle: { task in viewModel.toggle(task: task) },</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        onClickBody: { task in viewModel.clickedBody(task: task) }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    )</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><p>This will tell the list to iterate over all the <code>viewModel.tasks</code> and render a <code>TaskRow</code>. In each of the <code>TaskRow</code> children, we need to bind the <code>onToggle</code> and <code>onClick</code> callbacks to the viewModel methods.</p><ol start="4"><li>Bind the plus button to the <code>viewModel.clickedPlus</code> event</li><li>Now we need to present a <code>.sheet</code> which will activate based on the <code>$viewModel.isPresentingEditScreen</code> variable. Notice how we added the <code>$</code> before <code>viewModel</code>. <code>.sheet</code> can edit the <code>isPresentingEditScreen</code> once it&#x27;s dismissed, so we need to treat the variable as a bidirectional binding.</li><li>We&#x27;ve also included a <code>TasksListScreen_Previews</code> so that you can add some test data and see the result in a live view.</li></ol><p><img alt="xcode TasksListScreen_Previews.png" src="/assets/images/xcode-taskslistscreen-preview-7011abc616291382a35ae49c91d1ac6a.png"></p><div class="codeBlockContainer_2gih"><div style="color:#9CDCFE;background-color:#1E1E1E" class="codeBlockTitle_1Kb7">TasksListScreen.swift</div><div class="codeBlockContent_3z4W swift"><pre tabindex="0" class="prism-code language-swift codeBlock_6upA thin-scrollbar"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#9CDCFE"><span class="token plain">struct TasksListScreen: View {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // 2.</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    let ditto: Ditto</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    // 1.</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    @ObservedObject var viewModel: TasksListScreenViewModel</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    init(ditto: Ditto) {</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">        self.ditto = ditto</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">        self.viewModel = TasksListScreenViewModel(ditto: ditto)</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    var body: some View {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        NavigationView {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            List {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                // 3.</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">                ForEach(viewModel.tasks) { task in</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">                    TaskRow(task: task,</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">                        onToggle: { task in viewModel.toggle(task: task) },</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">                        onClickBody: { task in viewModel.clickedBody(task: task) }</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">                    )</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">                }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .navigationTitle(&quot;Tasks - SwiftUI&quot;)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            .navigationBarItems(trailing: Button(action: {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                // 4</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">                viewModel.clickedPlus()</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }, label: {</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                Image(systemName: &quot;plus&quot;)</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            }))</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            // 5.</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">            .sheet(isPresented: $viewModel.isPresentingEditScreen, content: {</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">                EditScreen(ditto: ditto, task: viewModel.taskToEdit)</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">            })</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// 6.</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">struct TasksListScreen_Previews: PreviewProvider {</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    static var previews: some View {</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">        TasksListScreen(ditto: Ditto())</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">    }</span></span><span class="token-linebg-gray-800 docusaurus-highlight-code-line bg-gray-700" style="color:#9CDCFE"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_2e3i clean-btn"><div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline mr-1"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg><span class="text-xs">Copy</span></div></button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>Notice that we <em>DO NOT HAVE TO</em> manipulate the <code>tasks</code> value. Calling <code>.update</code> on <code>ditto</code> will automatically fire the liveQuery to update the <code>tasks</code>. You can always trust the liveQuery to immediately update the <code>@Published var tasks</code>. There is no reason to poll or force reload. Ditto will automatically handle the state changes and SwiftUI will pick these changes up automatically.</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/getditto/docs/tree/main/docs/ios/tutorial/swift/3-tasks-list-screen.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ios/tutorial/swift/configure-ditto"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->2 - Configure Ditto</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ios/tutorial/swift/edit-screen"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">4 - Editing Tasks<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#3-1-create-a-taskrow-views" class="table-of-contents__link toc-highlight">3-1 Create a <code>TaskRow</code> views</a></li><li><a href="#3-2-create-a-taskslistscreenviewmodel" class="table-of-contents__link toc-highlight">3-2 Create a <code>TasksListScreenViewModel</code></a></li><li><a href="#3-3-render-taskrow-in-a-foreach-within-the-taskslistscreen" class="table-of-contents__link toc-highlight">3-3 Render <code>TaskRow</code> in a <code>ForEach</code> within the <code>TasksListScreen</code></a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Documentation</a></li><li class="footer__item"><a href="https://www.ditto.live/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Main Website</span></a></li><li class="footer__item"><a href="https://github.com/getditto/samples" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Example Apps</span></a></li><li class="footer__item"><a class="footer__link-item" href="/changelog">Changelog</a></li><li class="footer__item"><a href="https://portal.ditto.live" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Login</span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/getditto/docs/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub Discussions</span></a></li><li class="footer__item"><a href="https://github.com/getditto/docs/discussions/categories/roadmap-and-ideas" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Roadmap</span></a></li><li class="footer__item"><a href="https://github.com/getditto/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Open Source</span></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/ditto" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow</span></a></li><li class="footer__item"><a href="https://twitter.com/dittolive" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter</span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 DittoLive, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c44b045c.js"></script>
<script src="/assets/js/main.35dec2f9.js"></script>
<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PV7QFWF" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) --></body>
</html>